---
title: "AFMC We Need - Text Mining Project"
subtitle: "Interim Report to AFMC"
author: "Jason Freels"
date: "2/26/2020"
output: 
  html_document:
    df_print: "paged"
    toc: true
    toc_float: yes
---

```{r setup, include=FALSE, eval=FALSE}
knitr::opts_chunk$set(echo = TRUE)
devtools::install_github("clawilso15/Text.Replace")
```

## Background

Purpose of project is to extract insights from survey data where data exists is a columnar format

Survey asks respondents about how to improve by identifying both positive and negative trends

Assumption - respondents state what they would like to see more of and what they want to see less of

Respondents want to see an increased trend of positives and a decreasing trend of negatives

- It is assumed that respondents will use certain phrases to identify these desires for trends

```{r}
library(Text.Replace)

# Example on the AFMC We Need Data
# data set located on another machine due to permissions

csv = file.choose()
DATA = readr::read_csv(csv)
AFMC_corpus = Text.Replace::create_corpus(DATA, "Comments")
```

```{r}
AFMC_dfm = Text.Replace:::create_dfm(AFMC_corpus, 
                                     num_ngrams = 6,
                                     remove_punct = T,
                                     tolower = TRUE, 
                                     stem = FALSE, 
                                     select = NULL, 
                                     remove = NULL, 
                                     dictionary = NULL, 
                                     thesaurus = NULL, 
                                     groups = NULL)
```

```{r, fig.width=10}
AFMC_dfm_Q1 = quanteda::dfm_subset(AFMC_dfm[[1]], subset = Question == 1)

AFMC_dfm_trim = quanteda::dfm_trim(AFMC_dfm_Q1, 
                                   min_termfreq = 10)
```

```{r}
# basic wordcloud
quanteda::textplot_wordcloud(AFMC_dfm_trim)

freq <- Matrix::colSums(AFMC_dfm_trim)
word <- names(freq)
freq <- unname(freq)
ord <- order(freq, decreasing = T)
word <- word[ord]
freq <- freq[ord]

df <- data.frame(term = word, frequency = freq) ; df
```

```{r, eval=FALSE}
kwic(toks, pattern = phrase(multiword))
```

```{r}
  tidy_out1 %>%
    top_n(10) %>%
    ungroup() %>%
    mutate(bigram = reorder(term, count)) %>%
    ggplot(aes(bigram, count, fill = count)) +
    geom_col(show.legend = FALSE) +
    labs(y = "Mentions",
         x = NULL) +
    coord_flip()
```